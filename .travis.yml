language: node_js
node_js:
- v12.18.3
cache:
  directories:
  - node_modules
env:
  matrix:
  - DATABASE_HOST=localhost MYSQL_DATABASE=cherrytwist MYSQL_ROOT_PASSWORD=toor AUTH_ENABLED=true
    LOGGING_CONSOLE_ENABLED=false AUTH_AAD_UPN_DOMAIN=devcherrytwist.onmicrosoft.com
    AUTH_AAD_CLIENT_APP_ID=6f4fcdb2-5792-4e17-bbdc-14ac0cf78496 AUTH_AAD_CHERRYTWIST_API_SCOPE=api://869e0dc2-907e-45fe-841f-34cc93beee63/.default
    AUTH_AAD_TENANT=22e3aada-5a09-4e2b-9e0e-dc4f02328b29 AUTH_AAD_CHERRYTWIST_API_APP_ID=869e0dc2-907e-45fe-841f-34cc93beee63
    AUTH_AAD_MSGRAPH_API_SCOPE="Directory.AccessAsUser.All Directory.ReadWrite.All
    User.ReadWrite.All"
  global:
    secure: F0SgEMTWf9lmY2e6JD1539JLEPPQ4QL+X5Vs3YgpV3xpOv+SmUlezVZGRIXlwjXjClXcS3zghdeTrYk9tMsf14mWnO5MF70cPMRa7ml1igScsxT4mW3HcZ+WO+M0JSpgEOC/FW2Gu4Sp5oWsYFrn9miCvIycWGjPTKvK2tDGJ/zMeQSmMFC3nGGUrhB89dBRCBr6WnCS620npRBu599OQV5TWv7Pvv0ndy1LC6nnGYp9zOqskpTVvXvuiudxTuTVA6440LMqFTlsb9ocPuPydNH4V5890OVpiTxJOEIW+oh3dbkFSwuY93AxxXUyhGPIIo+DZItK6xeNkMSl2xYSDkSQd+HajXGoRsM1WsUvIyBLUPZobn+SHjl5npnhhZCm88htuVTpBqYxAvPwKaEhGcmtgK97QdGm5Z4uwiWnqIBLqNxZ/M0b8YPl4oNhw166URXIFhVfKmSJc7cGDlajppJp3l16ei5dFX/z+z5Wx4YTC6fDqnGn3tFCr20QfHuk1/9obtMQX4n2sEjoSo6NDrHCkRSC8glX6xE/mMtlMTKuS6OI+RCDgIEz2L3rdLQsBhdLtJGFOxswyuzh9qCO2OB1wWiJgoZ/mpS91i0pii38MoI5ncoRzEVwKlqby8l5fkQLYW952MepTutho6oGYLyipE2t9NaVUGZifbywGOU=
install:
- npm install
services:
- mysql
before_install:
- mysql -e 'CREATE DATABASE IF NOT EXISTS cherrytwist;'
before_script:
- echo "USE mysql;ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password
  BY 'toor';;\nFLUSH PRIVILEGES;\n" | mysql -u root
script: ".scripts/run-tests.sh"
