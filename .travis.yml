language: node_js
node_js:
- v12.18.3
cache:
  directories:
  - node_modules
env:
  matrix:
  - DATABASE_HOST=localhost MYSQL_DATABASE=cherrytwist MYSQL_ROOT_PASSWORD=toor AUTH_ENABLED=true
    LOGGING_CONSOLE_ENABLED=false AUTH_AAD_UPN_DOMAIN=devcherrytwist.onmicrosoft.com
    AUTH_AAD_CLIENT_APP_ID=6f4fcdb2-5792-4e17-bbdc-14ac0cf78496 AUTH_AAD_CHERRYTWIST_API_SCOPE=api://869e0dc2-907e-45fe-841f-34cc93beee63/.default
    AUTH_AAD_TENANT=22e3aada-5a09-4e2b-9e0e-dc4f02328b29 AUTH_AAD_CHERRYTWIST_API_APP_ID=869e0dc2-907e-45fe-841f-34cc93beee63
    AUTH_AAD_MSGRAPH_API_SCOPE="Directory.AccessAsUser.All Directory.ReadWrite.All
    User.ReadWrite.All"
  global:
    secure: gwDE9UlH1zJF1dtxJeOyGa3YRjm2SonoM9csnLhq3gBv2et9DPHsK3KtilJcmO5/oFhiZJ7S+90/MFTOrkUqAutEV+ro00vJ1dW30D/vJepWh8hA4gcMFWhXVNTrN9zF48Cq+6oCs0jP0vjZxgyBw4hWrrh20kPMuXlSDzoSOD7kFXH9Vj7WmjqXqtor5lUVc7u3jn9iCPAeA5ENAf7Tx2LZXKkY7lZSRM2sUxPfoFRkIf+NVic8MsbkxmFxvPaSrfr9sFItbx8Y3UpUG9i3qRWq0fMcHx/dJHgcKDtNzsn/qdfIcS3LZYW7sVAs0ekIR/gLtwRIOc6VeoSepg6iaR8s1rdhOmh1vukySVweneMflWtkhevZdwlYTeAR9zrmLU74V+NfCNa6KUv9YxMVeI3MZjU+7W0bEKkJQbZIwz9BGfI1M1TtsHK9BP327cLC+2s+htGJeXTLhXvV01dbuC4qsWgfWYap3mue07Qa2vbp629Sepf2mZ4PUgjxxqr2M6phmCeEZLmG9V2z/buFC03ky0LqioijsPsqnWaOj75M2V2vAiytW9wUe6N5dGV3C1GXb9cikvQPG4zjOc64rgKMbmA20VV8prsd+BLT3yC8yzhNb8VQClpKkdl/UVR3VBeN40PBAPV/C5wPe42C9opWNd0v9ZqGjW8iJZVAWzg=
install:
- npm install
services:
- mysql
before_install:
- mysql -e 'CREATE DATABASE IF NOT EXISTS cherrytwist;'
before_script:
- echo "USE mysql;ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password
  BY 'toor';;\nFLUSH PRIVILEGES;\n" | mysql -u root
script: ".scripts/run-tests.sh"
